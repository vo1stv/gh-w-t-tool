# Load an environment with PanDoc preinstalled

name: Pandoc

on:
  push:
      branches:
        - actions  
      paths:
        - '.github/workflows/pandoc.yml'
  schedule:
    # * is a special character in YAML so you have to quote this string
    - cron:  '0 0 * * *'

jobs:
  convert_via_pandoc:
    runs-on: ubuntu-18.04
    steps:
      # https://github.community/t5/GitHub-Actions/Use-docker-images-from-GitHub-Package-Registry/td-p/30407
      - name: Docker login
        run: docker login docker.pkg.github.com -u $GITHUB_ACTOR -p $GITHUB_TOKEN
        env:
             GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}    

      - name: Pull Docker image
        run: docker pull "hub.docker.com/pandoc/latex:2.9"

      - name: Run image
        run: docker run -it -d --name pandocker -v $GITHUB_WORKSPACE:/workspace -w /workspace docker.pkg.github.com/$GITHUB_REPOSITORY/firmware-builder:latest
        
      - name: test
        run: docker exec pandocker  bash -c 'pandoc --help'
